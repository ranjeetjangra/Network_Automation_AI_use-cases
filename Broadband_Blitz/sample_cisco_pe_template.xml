<config-template xmlns="http://tail-f.com/ns/config/1.0">
    <devices xmlns="http://tail-f.com/ns/ncs">
        <device tags="nocreate">
            <name>{$device}</name>
            <config tags="merge">
                <dhcp xmlns="http://tail-f.com/ned/cisco-ios-xr" when="{$service_type='business-dynamic'}">
                    <ipv4>
                        <profile>
                            <name>relay-profile-{$vrf}</name>
                            <type>relay</type>
                            <helper-address>
                                <vrf>{$vrf}</vrf>
                                <address>10.104.142.88</address>
                            </helper-address>
                            <helper-address>
                                <vrf>{$vrf}</vrf>
                                <address>10.105.40.88</address>
                            </helper-address>
                            <relay>
                                <information>
                                    <option>
                                        <allow-untrusted/>
                                    </option>
                                </information>
                            </relay>
                        </profile>
                        <interface>
                            <name>{$interface_type}{$interface_id}.{$vlan_id}</name>
                            <type>relay</type>
                            <profile>relay-profile-{$vrf}</profile>
                        </interface>
                    </ipv4>
                </dhcp>
                <interface xmlns="http://tail-f.com/ned/cisco-ios-xr">
                    <?if {$interface_type="GigabitEthernet"}?>
                    <GigabitEthernet-subinterface>
                        <GigabitEthernet>
                            <id>{$interface_id}.{$vlan_id}</id>
                            <description>{$interface_description}</description>
                            <encapsulation>
                                <dot1q>
                                    <vlan-id>{$vlan_id}</vlan-id>
                                </dot1q>
                            </encapsulation>
                            <service-policy>
                                <input>
                                    <name>{$inpolicy}</name>
                                </input>
                                <output>
                                    <name>{$outpolicy}</name>
                                </output>
                            </service-policy>
                            <vrf>{$vrf}</vrf>
                            <ipv4>
                                <address>
                                    <ip>{$ipaddr}</ip>
                                    <mask>{$netmask}</mask>
                                </address>
                                <access-group>
                                    <direction>ingress</direction>
                                    <name>101</name>
                                </access-group>
                            </ipv4>
                            <load-interval>30</load-interval>
                        </GigabitEthernet>
                    </GigabitEthernet-subinterface>
                    <?end?>
                    <?if {$interface_type="FastEthernet"}?>
                    <FastEthernet-subinterface>
                        <FastEthernet>
                            <id>{$interface_id}.{$vlan_id}</id>
                            <description>{$interface_description}</description>
                            <encapsulation>
                                <dot1q>
                                    <vlan-id>{$vlan_id}</vlan-id>
                                </dot1q>
                            </encapsulation>
                            <service-policy>
                                <input>
                                    <name>{$inpolicy}</name>
                                </input>
                                <output>
                                    <name>{$outpolicy}</name>
                                </output>
                            </service-policy>
                            <vrf>{$vrf}</vrf>
                            <ipv4>
                                <address>
                                    <ip>{$ipaddr}</ip>
                                    <mask>{$netmask}</mask>
                                </address>
                                <access-group>
                                    <direction>ingress</direction>
                                    <name>101</name>
                                </access-group>
                            </ipv4>
                            <load-interval>30</load-interval>
                        </FastEthernet>
                    </FastEthernet-subinterface>
                    <?end?>
                    <?if {$interface_type="TenGigE"}?>
                    <TenGigE-subinterface>
                        <TenGigE>
                            <id>{$interface_id}.{$vlan_id}</id>
                            <description>{$interface_description}</description>
                            <encapsulation>
                                <dot1q>
                                    <vlan-id>{$vlan_id}</vlan-id>
                                </dot1q>
                            </encapsulation>
                            <service-policy>
                                <input>
                                    <name>{$inpolicy}</name>
                                </input>
                                <output>
                                    <name>{$outpolicy}</name>
                                </output>
                            </service-policy>
                            <vrf>{$vrf}</vrf>
                            <ipv4>
                                <address>
                                    <ip>{$ipaddr}</ip>
                                    <mask>{$netmask}</mask>
                                </address>
                                <access-group>
                                    <direction>ingress</direction>
                                    <name>101</name>
                                </access-group>
                            </ipv4>
                            <load-interval>30</load-interval>
                        </TenGigE>
                    </TenGigE-subinterface>
                    <?end?>
                    <?if {$interface_type="HundredGigE"}?>
                    <HundredGigE-subinterface>
                        <HundredGigE>
                            <id>{$interface_id}.{$vlan_id}</id>
                            <description>{$interface_description}</description>
                            <encapsulation>
                                <dot1q>
                                    <vlan-id>{$vlan_id}</vlan-id>
                                </dot1q>
                            </encapsulation>
                            <service-policy>
                                <input>
                                    <name>{$inpolicy}</name>
                                </input>
                                <output>
                                    <name>{$outpolicy}</name>
                                </output>
                            </service-policy>
                            <vrf>{$vrf}</vrf>
                            <ipv4>
                                <address>
                                    <ip>{$ipaddr}</ip>
                                    <mask>{$netmask}</mask>
                                </address>
                                <access-group>
                                    <direction>ingress</direction>
                                    <name>101</name>
                                </access-group>
                            </ipv4>
                            <load-interval>30</load-interval>
                        </HundredGigE>
                    </HundredGigE-subinterface>
                    <?end?>
                    <?if {$interface_type="Bundle-Ether"}?>
                    <Bundle-Ether-subinterface>
                        <Bundle-Ether>
                            <id>{$interface_id}.{$vlan_id}</id>
                            <description>{$interface_description}</description>
                            <encapsulation>
                                <dot1q>
                                    <vlan-id>{$vlan_id}</vlan-id>
                                </dot1q>
                            </encapsulation>
                            <service-policy>
                                <input>
                                    <name>{$inpolicy}</name>
                                </input>
                                <output>
                                    <name>{$outpolicy}</name>
                                </output>
                            </service-policy>
                            <vrf>{$vrf}</vrf>
                            <ipv4>
                                <address>
                                    <ip>{$ipaddr}</ip>
                                    <mask>{$netmask}</mask>
                                </address>
                                <access-group>
                                    <direction>ingress</direction>
                                    <name>101</name>
                                </access-group>
                            </ipv4>
                            <load-interval>30</load-interval>
                        </Bundle-Ether>
                    </Bundle-Ether-subinterface>
                    <?end?>
                </interface>
                <?if {$vrrp_hsrp_id and $vrrp_hsrp_priority and $service_type="premium"}?>
                <router xmlns="http://tail-f.com/ned/cisco-ios-xr">
                    <vrrp>
                        <interface>
                            <name>{$interface_type}{$interface_id}.{$vlan_id}</name>
                            <address-family>
                                <ipv4>
                                    <vrrp>
                                        <id>{$vrrp_hsrp_id}</id>
                                        <priority>{$vrrp_hsrp_priority}</priority>
                                        <?if {$timer_msec}?>
                                        <timer>
                                            <msec>{$timer_msec}</msec>
                                            <force/>
                                        </timer>
                                        <?end?>
                                        <address>
                                            <ip>{$vrrp_hsrp_vip}</ip>
                                        </address>
                                    </vrrp>
                                </ipv4>
                            </address-family>
                        </interface>
                    </vrrp>
                </router>
                <?end?>
            </config>
        </device>
    </devices>
</config-template>
